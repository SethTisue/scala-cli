"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8368],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return d}});var n=a(7294);function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var o=n.createContext({}),c=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(o.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,s=e.mdxType,r=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=c(a),d=s,f=m["".concat(o,".").concat(d)]||m[d]||u[d]||r;return a?n.createElement(f,i(i({ref:t},p),{},{components:a})):n.createElement(f,i({ref:t},p))}));function d(e,t){var a=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=a.length,i=new Array(r);i[0]=m;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:s,i[1]=l;for(var c=2;c<r;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},7144:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return i},contentTitle:function(){return l},metadata:function(){return o},toc:function(){return c},default:function(){return u}});var n=a(7462),s=a(3366),r=(a(7294),a(3905)),i={title:"Test",sidebar_position:7},l=void 0,o={unversionedId:"commands/test",id:"commands/test",isDocsHomePage:!1,title:"Test",description:"The test command allows to run test suites that come from the test sources.",source:"@site/docs/commands/test.md",sourceDirName:"commands",slug:"/commands/test",permalink:"/docs/commands/test",editUrl:"https://github.com/Virtuslab/scala-cli/edit/master/website/docs/commands/test.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{title:"Test",sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Run",permalink:"/docs/commands/run"},next:{title:"Package",permalink:"/docs/commands/package"}},c=[{value:"Test sources",id:"test-sources",children:[]},{value:"Test framework",id:"test-framework",children:[]},{value:"Test arguments",id:"test-arguments",children:[]}],p={toc:c};function u(e){var t=e.components,a=(0,s.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"test")," command allows to run test suites that come from the test sources.\nTest sources are complied separately (after the 'main' sources) and may use different dependencies, compiler options and other configuration. "),(0,r.kt)("p",null,"All command line options applies to the both main and test sources so ",(0,r.kt)("a",{parentName:"p",href:"http://localhost:3000/docs/guides/using-directives"},"using directives")," (or ",(0,r.kt)("a",{parentName:"p",href:"../guides/configuration#special-imports"},"special imports"),".md) can be used to provide test-specific configuration. "),(0,r.kt)("h2",{id:"test-sources"},"Test sources"),(0,r.kt)("p",null,"Given source file is treated as test source if:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"contains ",(0,r.kt)("inlineCode",{parentName:"li"},"using target test")," directive"),(0,r.kt)("li",{parentName:"ul"},"file name ends with ",(0,r.kt)("inlineCode",{parentName:"li"},".test.scala")),(0,r.kt)("li",{parentName:"ul"},"file comes from a directory that is provided as input, and relative path from that file to its original directory contains ",(0,r.kt)("inlineCode",{parentName:"li"},"test")," directory.")),(0,r.kt)("p",null,"The last rule may sound a bit more complicated so lets explain it using following file structure:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:"ignore",ignore:!0},"example/\n\u251c\u2500\u2500 a.scala\n\u251c\u2500\u2500 a.test.scala\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 main\n    \u2502   \u2514\u2500\u2500 scala\n    \u2502       \u2514\u2500\u2500 d.scala\n    \u251c\u2500\u2500 test\n    \u2502   \u2514\u2500\u2500 scala\n    \u2502       \u2514\u2500\u2500 b.scala\n    \u2514\u2500\u2500 test_unit\n        \u2514\u2500\u2500 scala\n            \u2514\u2500\u2500 e.scala\n")),(0,r.kt)("p",null,"Now, lets analyze what file will be treated as tests based on the provided inputs."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"scala-cli example")," will result in following files treated as test sources:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"a.test.scala")," - since it ends with ",(0,r.kt)("inlineCode",{parentName:"li"},".test.scala")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"src/test/scala/b.scala")," - since it comes from a directory and relative path to that directory contains ",(0,r.kt)("inlineCode",{parentName:"li"},"test"))),(0,r.kt)("p",null,"Please note that e.scala was not treated as test source since it lacks directory named precisly ",(0,r.kt)("inlineCode",{parentName:"p"},"test")," on its relative path to one of inputs (",(0,r.kt)("inlineCode",{parentName:"p"},"test_unit")," only starts with ",(0,r.kt)("inlineCode",{parentName:"p"},"test"),")."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"scala-cli example/src")," will result in ",(0,r.kt)("inlineCode",{parentName:"p"},"src/test/scala/b.scala")," being treated as tests since again its relative path to the one of the input directories (",(0,r.kt)("inlineCode",{parentName:"p"},"test/scala/b.scala"),") contains test directory."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"scala-cli example/src/test")," will result in no test sources since the relative path to ",(0,r.kt)("inlineCode",{parentName:"p"},"b.scala")," does not contains ",(0,r.kt)("inlineCode",{parentName:"p"},"test")," (the fact that directory provided as input is named ",(0,r.kt)("inlineCode",{parentName:"p"},"test")," does not make its content a test sources)."),(0,r.kt)("p",null,"Directives take precedence over file or path names, so ",(0,r.kt)("inlineCode",{parentName:"p"},"using target main")," can be used to force ",(0,r.kt)("inlineCode",{parentName:"p"},"test/a.scala")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"a.test.scala")," to not be treated as tests."),(0,r.kt)("p",null,"As a rule of thumb, we recommend to simply name all your tests file with ",(0,r.kt)("inlineCode",{parentName:"p"},".tests.scala")," suffix."),(0,r.kt)("h2",{id:"test-framework"},"Test framework"),(0,r.kt)("p",null,"In order to run tests with it, add a test framework dependency to your\napplication. Some of the most popular test frameworks in Scala are"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://scalameta.org/munit"},"munit"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"org.scalameta::munit::0.7.27")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/com-lihaoyi/utest"},"utest"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"com.lihaoyi::utest::0.7.10")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.scalatest.org"},"ScalaTest"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"org.scalatest::scalatest::3.2.9")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://junit.org/junit4"},"JUnit 4"),", that can be used via a ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/sbt/junit-interface"},"dedicated interface"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"com.github.sbt:junit-interface:0.13.2"))),(0,r.kt)("p",null,"For example, let's run a simple munit-based test suite:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=MyTests.scala",title:"MyTests.scala"},'using lib org.scalameta::munit::0.7.27\n\nclass MyTests extends munit.FunSuite {\n  test("foo") {\n    assert(2 + 2 == 4)\n  }\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli test MyTests.scala\n# Compiling project_8686a5fa42 (1 Scala source)\n# Compiled 'project_8686a5fa42'\n# MyTests:\n#   + foo 0.143s\n")),(0,r.kt)("h2",{id:"test-arguments"},"Test arguments"),(0,r.kt)("p",null,"You can pass test arguments to your test framework, by passing them after a ",(0,r.kt)("inlineCode",{parentName:"p"},"--"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=MyTests.scala",title:"MyTests.scala"},'import $ivy.`org.scalatest::scalatest::3.2.9`\n\nimport org.scalatest._\nimport org.scalatest.flatspec._\nimport org.scalatest.matchers._\n\nclass Tests extends AnyFlatSpec with should.Matchers {\n  "A thing" should "thing" in {\n    assert(2 + 2 == 4)\n  }\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli test MyTests.scala -- -oD\n# Compiling project_8686a5fa42-4bae49baeb (1 Scala source)\n# Compiled 'project_8686a5fa42-4bae49baeb'\n# Tests:\n# A thing\n# - should thing (22 milliseconds)\n# Run completed in 359 milliseconds.\n# Total number of tests run: 1\n# Suites: completed 1, aborted 0\n# Tests: succeeded 1, failed 0, canceled 0, ignored 0, pending 0\n# All tests passed.\n")))}u.isMDXComponent=!0}}]);